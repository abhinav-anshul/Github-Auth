{"version":3,"file":"index.js","sources":["../dist-src/get-token.js","../dist-src/index.js"],"sourcesContent":["import jsonwebtoken from \"jsonwebtoken\";\nexport async function getToken({ privateKey, payload }) {\n    return jsonwebtoken.sign(payload, privateKey, {\n        algorithm: \"RS256\"\n    });\n}\n","import { getToken } from \"./get-token\";\nexport async function githubAppJwt({ id, privateKey }) {\n    // When creating a JSON Web Token, it sets the \"issued at time\" (iat) to 30s\n    // in the past as we have seen people running situations where the GitHub API\n    // claimed the iat would be in future. It turned out the clocks on the\n    // different machine were not in sync.\n    const now = Math.floor(Date.now() / 1000) - 30;\n    const expiration = now + 60 * 10; // JWT expiration time (10 minute maximum)\n    const payload = {\n        iat: now,\n        exp: expiration,\n        iss: id\n    };\n    const token = await getToken({\n        privateKey,\n        payload\n    });\n    return {\n        appId: id,\n        expiration,\n        token\n    };\n}\n"],"names":["getToken","privateKey","payload","jsonwebtoken","sign","algorithm","githubAppJwt","id","now","Math","floor","Date","expiration","iat","exp","iss","token","appId"],"mappings":";;;;;;;;AACO,eAAeA,QAAf,CAAwB;AAAEC,EAAAA,UAAF;AAAcC,EAAAA;AAAd,CAAxB,EAAiD;AACpD,SAAOC,YAAY,CAACC,IAAb,CAAkBF,OAAlB,EAA2BD,UAA3B,EAAuC;AAC1CI,IAAAA,SAAS,EAAE;AAD+B,GAAvC,CAAP;AAGH;;ACJM,eAAeC,YAAf,CAA4B;AAAEC,EAAAA,EAAF;AAAMN,EAAAA;AAAN,CAA5B,EAAgD;AACnD;AACA;AACA;AACA;AACA,QAAMO,GAAG,GAAGC,IAAI,CAACC,KAAL,CAAWC,IAAI,CAACH,GAAL,KAAa,IAAxB,IAAgC,EAA5C;AACA,QAAMI,UAAU,GAAGJ,GAAG,GAAG,KAAK,EAA9B,CANmD;;AAOnD,QAAMN,OAAO,GAAG;AACZW,IAAAA,GAAG,EAAEL,GADO;AAEZM,IAAAA,GAAG,EAAEF,UAFO;AAGZG,IAAAA,GAAG,EAAER;AAHO,GAAhB;AAKA,QAAMS,KAAK,GAAG,MAAMhB,QAAQ,CAAC;AACzBC,IAAAA,UADyB;AAEzBC,IAAAA;AAFyB,GAAD,CAA5B;AAIA,SAAO;AACHe,IAAAA,KAAK,EAAEV,EADJ;AAEHK,IAAAA,UAFG;AAGHI,IAAAA;AAHG,GAAP;AAKH;;;;"}